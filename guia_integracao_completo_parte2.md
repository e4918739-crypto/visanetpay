# üìã Guia Completo de Integra√ß√£o VisaNetPay - PARTE 2
## Comandos MGX e Troubleshooting Completo

---

## üõ†Ô∏è **COMANDOS MGX √öTEIS**

```bash
# SINCRONIZA√á√ÉO
mgx sync                     # Sincronizar projeto com plataforma
mgx pull-suggestions        # Baixar sugest√µes IA mais recentes
mgx push-changes            # Enviar mudan√ßas para an√°lise

# AN√ÅLISE DE C√ìDIGO
mgx analyze --full          # An√°lise completa do c√≥digo
mgx analyze --security      # Foco em seguran√ßa apenas
mgx analyze --performance   # Foco em performance apenas
mgx lint --ai              # Linting com sugest√µes IA

# TESTES E QUALIDADE
mgx test --ai-suggestions   # Executar testes com insights IA
mgx test --generate        # Gerar testes automaticamente
mgx coverage --report      # Relat√≥rio cobertura de testes

# DEPLOY E AMBIENTE
mgx deploy --env staging    # Deploy para staging
mgx deploy --env prod --verify  # Deploy produ√ß√£o com verifica√ß√µes
mgx rollback --to-stable   # Rollback para vers√£o est√°vel
mgx status --all           # Status todos os ambientes

# DOCUMENTA√á√ÉO
mgx docs generate          # Gerar documenta√ß√£o autom√°tica
mgx docs update           # Atualizar docs existentes
mgx changelog            # Gerar changelog autom√°tico

# SEGURAN√áA E AUDIT
mgx security-scan --detailed    # Scan seguran√ßa detalhado
mgx vulnerabilities --fix      # Corrigir vulnerabilidades automaticamente
mgx compliance --check        # Verificar compliance regulat√≥rio

# PERFORMANCE
mgx optimize --bundle      # Otimizar bundle size
mgx optimize --images     # Otimizar imagens automaticamente
mgx benchmark            # Executar benchmarks performance

# COLABORA√á√ÉO
mgx review --assign       # Atribuir reviewers automaticamente  
mgx merge --smart        # Merge inteligente com verifica√ß√µes
mgx notify --team       # Notificar equipe sobre mudan√ßas
```

### **üéØ Exemplos Pr√°ticos de Uso MGX**

#### **Cen√°rio 1: Nova Feature Completa**
```bash
# 1. Criar feature com IA
mgx create feature "Sistema de Relat√≥rios Financeiros"
# MGX pergunta especifica√ß√µes e gera estrutura

# 2. Desenvolvimento local
git checkout -b feature/relatorios-financeiros
# ... desenvolvimento ...

# 3. An√°lise antes do commit
mgx analyze --pre-commit
# MGX sugere melhorias antes de commitar

# 4. Commit e push
git add .
git commit -m "feat: implementar sistema de relat√≥rios financeiros"
git push origin feature/relatorios-financeiros

# 5. MGX automaticamente faz review e sugere melhorias
```

#### **Cen√°rio 2: Corre√ß√£o de Bug com IA**
```bash
# 1. Reportar bug para IA
mgx debug "Erro no c√°lculo de juros compostos"
# MGX analisa c√≥digo e sugere poss√≠veis causas

# 2. Implementar corre√ß√£o sugerida
git checkout -b fix/calculo-juros-compostos

# 3. Validar corre√ß√£o com IA
mgx test --focus "juros compostos"
# MGX executa testes espec√≠ficos e valida corre√ß√£o

# 4. Deploy seguro
mgx deploy --env staging --auto-test
```

---

## üõ†Ô∏è **TROUBLESHOOTING COMUM**

### **üêõ 1. Problemas com Git**

#### **"Permission denied (publickey)"**
**Causa**: SSH n√£o configurado corretamente

```bash
# Verificar se chave est√° carregada
ssh-add -l

# Se vazio, carregar chave
ssh-add ~/.ssh/id_ed25519

# Se chave n√£o existe, gerar nova
ssh-keygen -t ed25519 -C "seu-email@exemplo.com"

# Testar conex√£o
ssh -T git@github.com
```

#### **"Merge conflicts"**
**Causa**: Mudan√ßas conflitantes entre branches

```bash
# 1. Ver arquivos em conflito
git status

# 2. Abrir arquivos e resolver conflitos manualmente
# Procurar por marcadores:
<<<<<<< HEAD
seu c√≥digo atual
=======
c√≥digo conflitante
>>>>>>> nome-da-branch

# 3. Ap√≥s resolver, marcar como resolvido
git add arquivo-resolvido.js

# 4. Finalizar merge
git commit -m "resolve: conflitos de merge na feature X"
```

#### **"Your branch has diverged"**
**Causa**: Branch local diferente do remoto

```bash
# Op√ß√£o 1: Fazer merge (mant√©m hist√≥rico)
git fetch origin
git merge origin/main

# Op√ß√£o 2: Rebase (hist√≥rico limpo)
git fetch origin
git rebase origin/main

# Op√ß√£o 3: Reset (CUIDADO - perde mudan√ßas locais)
git fetch origin
git reset --hard origin/main
```

### **üì¶ 2. Problemas com Node.js/npm**

#### **"Module not found"**
**Causa**: Depend√™ncias n√£o instaladas ou cache corrompido

```bash
# Solu√ß√£o 1: Reinstalar depend√™ncias
rm -rf node_modules package-lock.json
npm install

# Solu√ß√£o 2: Limpar cache npm
npm cache clean --force
npm install

# Solu√ß√£o 3: Verificar Node.js version
node --version  # Deve ser 18+
nvm use 18     # Se usar nvm
```

#### **"EACCES permission denied"**
**Causa**: Permiss√µes incorretas (Linux/Mac)

```bash
# Solu√ß√£o 1: Usar nvm (recomendado)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
source ~/.bashrc
nvm install 18
nvm use 18

# Solu√ß√£o 2: Corrigir permiss√µes npm
sudo chown -R $(whoami) ~/.npm
sudo chown -R $(whoami) /usr/local/lib/node_modules
```

#### **"Out of memory" durante build**
**Causa**: Bundle muito grande ou mem√≥ria insuficiente

```bash
# Solu√ß√£o 1: Aumentar limite mem√≥ria
export NODE_OPTIONS="--max-old-space-size=4096"
npm run build

# Solu√ß√£o 2: Build em produ√ß√£o
NODE_ENV=production npm run build

# Solu√ß√£o 3: Analisar bundle size
npm install --save-dev webpack-bundle-analyzer
npm run build
npx webpack-bundle-analyzer .next/static/chunks/*.js
```

### **‚ö° 3. Problemas com Vercel**

#### **"Build failed" - Erro comum**
**Causa**: Erro no processo de build

```bash
# 1. Testar build localmente primeiro
cd shadcn-ui
npm run build

# 2. Se falhar localmente, verificar:
npm ls                    # Depend√™ncias instaladas
npm audit                # Vulnerabilidades  
npm run lint             # Erros de c√≥digo

# 3. Verificar logs Vercel Dashboard
# Procurar por: "Command failed", "Module not found", "Type error"

# 4. Solu√ß√µes comuns:
npm install              # Instalar depend√™ncias faltando
npm run build --verbose  # Build com logs detalhados
```

#### **"Environment variables n√£o funcionam"**
**Causa**: Vari√°veis mal configuradas ou n√£o prefixadas

```bash
# Para Next.js, vari√°veis do cliente DEVEM come√ßar com NEXT_PUBLIC_:
NEXT_PUBLIC_API_URL=https://api.exemplo.com     ‚úÖ Correto
API_URL=https://api.exemplo.com                 ‚ùå Errado (s√≥ servidor)

# Verificar no c√≥digo:
console.log('Cliente:', process.env.NEXT_PUBLIC_API_URL);      ‚úÖ Funciona
console.log('Servidor:', process.env.DATABASE_URL);           ‚úÖ S√≥ no servidor
console.log('Erro:', process.env.DATABASE_URL);               ‚ùå Undefined no cliente
```

#### **"Deploy travado/stuck"**
**Causa**: Build infinito ou erro n√£o reportado

```bash
# Solu√ß√£o 1: Cancelar e tentar novamente
# Vercel Dashboard ‚Üí Deployments ‚Üí Cancel Build

# Solu√ß√£o 2: Commit vazio para for√ßar novo deploy
git commit --allow-empty -m "trigger redeploy"
git push origin main

# Solu√ß√£o 3: Verificar logs Function
# Vercel Dashboard ‚Üí Functions ‚Üí Ver logs de erro
```

### **üöÄ 4. Problemas com MGX**

#### **"MGX sync failed"**
**Causa**: Conectividade ou autentica√ß√£o

```bash
# 1. Verificar status autentica√ß√£o
mgx auth status

# Se expirado:
mgx auth login
# Seguir instru√ß√µes de login

# 2. Verificar conectividade
ping mgx-api.platform.com

# 3. For√ßar sincroniza√ß√£o
mgx sync --force --verbose

# 4. Reconfigurar se necess√°rio
mgx config reset
mgx config init
```

#### **"AI suggestions n√£o aparecem"**
**Causa**: Quota esgotada ou servi√ßo indispon√≠vel

```bash
# 1. Verificar quota
mgx quota status

# 2. Verificar status servi√ßos
mgx status --services

# 3. Se quota esgotada:
mgx quota upgrade  # Ou esperar reset mensal

# 4. Configurar fallback
mgx config set ai_fallback true
```

#### **"Deploy autom√°tico n√£o funciona"**
**Causa**: Webhooks n√£o configurados

```bash
# 1. Verificar webhooks MGX
mgx webhooks list

# 2. Reconfigurar se necess√°rio
mgx webhooks setup --github --vercel

# 3. Testar webhook
mgx webhooks test

# 4. Verificar logs webhook
mgx webhooks logs --recent
```

### **üîß 5. Performance e Otimiza√ß√£o**

#### **"Site muito lento"**
**Causas e solu√ß√µes:**

```bash
# 1. Analisar bundle size
npm run build
ls -la .next/static/chunks/

# Se muito grande (>1MB):
# - Implementar code splitting
# - Lazy loading componentes
# - Remover depend√™ncias n√£o usadas

# 2. Verificar imagens
# Usar next/image para todas as imagens
# Formatos modernos: WebP, AVIF

# 3. Verificar Core Web Vitals
# Google PageSpeed: https://pagespeed.web.dev/
# Meta: LCP < 2.5s, FID < 100ms, CLS < 0.1
```

#### **"Memory leaks em desenvolvimento"**
**Causa**: useEffect sem cleanup ou listeners n√£o removidos

```javascript
// ‚ùå PROBLEMA: Effect sem cleanup
useEffect(() => {
  const interval = setInterval(() => {
    // c√≥digo...
  }, 1000);
  // Faltou cleanup!
}, []);

// ‚úÖ SOLU√á√ÉO: Sempre fazer cleanup
useEffect(() => {
  const interval = setInterval(() => {
    // c√≥digo...
  }, 1000);
  
  return () => clearInterval(interval);  // Cleanup
}, []);

// ‚ùå PROBLEMA: Event listener sem cleanup  
useEffect(() => {
  window.addEventListener('resize', handleResize);
  // Faltou remover listener!
}, []);

// ‚úÖ SOLU√á√ÉO: Remover listener
useEffect(() => {
  window.addEventListener('resize', handleResize);
  
  return () => window.removeEventListener('resize', handleResize);
}, []);
```

### **üîí 6. Problemas de Seguran√ßa**

#### **"API keys expostas"**
**Problema cr√≠tico**: Chaves de API no c√≥digo fonte

```bash
# ‚ùå NUNCA fazer:
const API_KEY = "sk-1234567890abcdef";  // Hardcoded no c√≥digo

# ‚úÖ CORRETO: 
const API_KEY = process.env.API_SECRET_KEY;  // Vari√°vel de ambiente

# Verificar se h√° chaves expostas:
git log --all -S "sk-" --source --all     # Procurar por "sk-" em commits
git log --all -S "key" --source --all     # Procurar por "key"

# Se encontrar chaves expostas:
# 1. Revogar chaves imediatamente no provedor
# 2. Gerar novas chaves  
# 3. Adicionar √†s vari√°veis de ambiente
# 4. Nunca fazer force-push para "limpar" - n√£o funciona!
```

#### **"Depend√™ncias com vulnerabilidades"**
**Causa**: Pacotes desatualizados com security issues

```bash
# 1. Verificar vulnerabilidades
npm audit

# Exemplo resultado:
# found 3 vulnerabilities (1 moderate, 2 high)
# run `npm audit fix` to fix them

# 2. Corrigir automaticamente (se poss√≠vel)
npm audit fix

# 3. Verificar se precisa corre√ß√£o manual
npm audit fix --force  # Cuidado - pode quebrar!

# 4. Para vulnerabilidades espec√≠ficas:
npm ls package-vulner√°vel
npm update package-vulner√°vel
```

### **üì± 7. Problemas Mobile/Responsivo**

#### **"Layout quebrado no mobile"**
**Causa**: CSS n√£o responsivo ou viewport mal configurado

```javascript
// ‚úÖ Verificar viewport no _document.js ou layout:
<meta name="viewport" content="width=device-width, initial-scale=1" />

// ‚úÖ Usar Tailwind responsive classes:
<div className="w-full md:w-1/2 lg:w-1/3">  // Responsivo
<div className="w-96">                       // ‚ùå Fixo - pode quebrar

// ‚úÖ Testar em diferentes tamanhos:
// Chrome DevTools ‚Üí Toggle device toolbar (Ctrl+Shift+M)
// Testar: Mobile (375px), Tablet (768px), Desktop (1024px+)
```

### **üîÑ 8. Problemas de Cache**

#### **"Mudan√ßas n√£o aparecem em produ√ß√£o"**
**Causa**: Cache agressivo do navegador ou CDN

```bash
# 1. Verificar se build tem hash √∫nico
ls .next/static/chunks/
# Deve ter: main-[hash].js, n√£o main.js

# 2. For√ßar refresh no navegador
# Ctrl+F5 (Windows/Linux) ou Cmd+Shift+R (Mac)

# 3. Verificar headers cache
curl -I https://seu-app.vercel.app
# Procurar: Cache-Control, ETag, Last-Modified

# 4. Limpar cache Vercel (se necess√°rio)
# Vercel Dashboard ‚Üí Settings ‚Üí Clear Cache
```

### **üÜò 9. Comandos de Emerg√™ncia**

#### **"Rollback imediato"**
```bash
# 1. Via Vercel (mais r√°pido - 30 segundos)
# Dashboard ‚Üí Deployments ‚Üí Deploy anterior ‚Üí Promote to Production

# 2. Via Git (mais controle)
git log --oneline                    # Ver commits
git revert HEAD                      # Reverter √∫ltimo commit
git push origin main                 # Deploy do revert

# 3. Reset completo (CUIDADO - perde dados!)
git reset --hard COMMIT_BOM_HASH
git push --force origin main
```

#### **"Site completamente fora do ar"**
```bash
# 1. Verificar status Vercel
https://vercel-status.com/

# 2. Verificar dom√≠nio
nslookup seu-dominio.com
ping seu-dominio.com

# 3. P√°gina manuten√ß√£o tempor√°ria
# Criar index.html simples e fazer deploy manual:
echo "<h1>Site em Manuten√ß√£o</h1>" > index.html
# Deploy via Vercel CLI ou interface

# 4. Comunicar usu√°rios
# Atualizar redes sociais, status page, etc.
```

---

## üìã **CHECKLIST DE SEGURAN√áA**

### **üîí Antes de Cada Deploy**

```bash
‚úÖ Verificar n√£o h√° chaves API hardcoded:
   grep -r "sk-" src/           # Stripe keys
   grep -r "pk_" src/           # Public keys  
   grep -r "secret" src/        # Secrets gerais
   
‚úÖ Audit de depend√™ncias:
   npm audit                    # Vulnerabilidades
   npm outdated                 # Atualiza√ß√µes dispon√≠veis
   
‚úÖ Vari√°veis de ambiente configuradas:
   echo $NEXT_PUBLIC_APP_URL    # URLs corretas
   echo $DATABASE_URL           # Banco configurado
   
‚úÖ Build funcionando:
   npm run build                # Build local OK
   npm run start                # Start local OK
   
‚úÖ Testes passando:
   npm run test                 # Se tiver testes
   npm run lint                 # Linting OK
```

### **üõ°Ô∏è Configura√ß√µes de Seguran√ßa**

```bash
‚úÖ GitHub:
   - Two-factor authentication habilitado
   - Branch protection rules configuradas
   - Secrets n√£o expostos em logs p√∫blicos
   
‚úÖ Vercel:
   - Environment variables configuradas
   - Domains com HTTPS
   - Analytics privacy-focused
   
‚úÖ C√≥digo:
   - Valida√ß√£o input usu√°rio
   - Sanitiza√ß√£o dados  
   - Rate limiting APIs
   - CORS configurado corretamente
```

---

## üéì **RESUMO E PR√ìXIMOS PASSOS**

### **üöÄ Parab√©ns! Voc√™ configurou:**

1. ‚úÖ **GitHub**: Reposit√≥rio seguro com SSH
2. ‚úÖ **Vercel**: Deploy autom√°tico funcionando  
3. ‚úÖ **Workflow**: Git flow profissional
4. ‚úÖ **Monitoramento**: Dashboards e alertas
5. ‚úÖ **MGX**: IA assistindo desenvolvimento
6. ‚úÖ **Troubleshooting**: Solu√ß√µes para problemas comuns

### **üéØ Pr√≥ximas Melhorias Sugeridas**

#### **Curto Prazo (1-2 semanas):**
```
üìä Analytics: Google Analytics 4
üß™ Testes: Jest + Testing Library  
üîí Seguran√ßa: Implementar CSP headers
üì± PWA: Service worker + manifest
```

#### **M√©dio Prazo (1-2 meses):**
```  
ü§ñ CI/CD: GitHub Actions completo
üìà Monitoring: Sentry error tracking
üèÉ‚Äç‚ôÇÔ∏è Performance: Core Web Vitals 100%
üåç i18n: Internacionaliza√ß√£o multi-idiomas
```

#### **Longo Prazo (3-6 meses):**
```
üß† AI/ML: An√°lise preditiva transa√ß√µes
‚ö° Edge: Cloudflare Workers integration  
üìä BI: Dashboard analytics avan√ßado
üîê Compliance: SOC2, PCI DSS
```

### **üìö Recursos de Aprendizado**

#### **Documenta√ß√£o Oficial:**
- **Next.js**: https://nextjs.org/docs
- **Vercel**: https://vercel.com/docs  
- **GitHub**: https://docs.github.com/
- **Git**: https://git-scm.com/docs

#### **Cursos Recomendados:**
- **Git/GitHub**: "Git & GitHub Crash Course" (YouTube)
- **Next.js**: "Next.js Full Course" (freeCodeCamp)
- **Deploy**: "Vercel Deployment Guide" (Vercel Learning)

#### **Comunidades:**
- **Discord**: Next.js, Vercel Community
- **Reddit**: r/webdev, r/nextjs
- **Stack Overflow**: Tag [nextjs], [vercel]

### **üÜò Suporte e Ajuda**

#### **Quando Precisar de Ajuda:**
1. **Consulte este guia** primeiro
2. **Verifique documenta√ß√£o oficial**  
3. **Busque no Google** erro espec√≠fico
4. **Pergunte comunidades** com c√≥digo exemplo
5. **Abra issue GitHub** se for bug do projeto

#### **Como Pedir Ajuda Efetivamente:**
```markdown
## Problema
Descri√ß√£o clara do que n√£o funciona

## Reprodu√ß√£o  
Passos exatos para reproduzir

## C√≥digo
```c√≥digo relevante```

## Erro
```mensagem de erro completa```

## Ambiente
- OS: Windows 10 / macOS / Linux
- Node.js: v18.17.0
- Next.js: v13.5.6
- Browser: Chrome 118
```

---

## üéâ **CONCLUS√ÉO**

Voc√™ agora tem um **sistema completo de desenvolvimento profissional** configurado para o VisaNetPay! 

**O que voc√™ consegue fazer:**
- ‚úÖ Desenvolver features com seguran√ßa
- ‚úÖ Deploy autom√°tico para produ√ß√£o
- ‚úÖ Monitorar performance e erros  
- ‚úÖ Colaborar com equipe efetivamente
- ‚úÖ Resolver problemas rapidamente

**Lembre-se sempre:**
- üîÑ **Sempre** fa√ßa pull antes de come√ßar
- üåø **Sempre** use branches para features
- üíæ **Sempre** teste antes de fazer merge
- üìä **Sempre** monitore ap√≥s deploy
- üîí **Nunca** commite secrets no c√≥digo

**Boa sorte com seu projeto VisaNetPay!** üöÄ

---

*√öltima atualiza√ß√£o: Dezembro 2024*
*Vers√£o do guia: v1.0.0*